(this.webpackJsonplabweb=this.webpackJsonplabweb||[]).push([[0],{339:function(e,t,a){e.exports=a(406)},344:function(e,t,a){},345:function(e,t,a){},406:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),i=a(15),c=a.n(i),l=(a(344),a(24)),r=a(99),s=(a(345),a(175)),d=a.n(s),u="";function m(e,t){return a=t,fetch(u+"/annotation/"+e,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});var a}window.location.href.startsWith("http://localhost:3000")&&(console.log("DEV mode detected, connecting to http://localhost:3800"),u="http://localhost:3800");var h=a(298);var f=function(e){var t=e.images;return null==t?o.a.createElement("div",null,"Loading ..."):o.a.createElement(d.a,{options:{padding:"dense",pageSize:8,pageSizeOptions:[8,50,100],rowStyle:function(t){return{backgroundColor:e.selectedImage&&e.selectedImage.path===t.path?"#EEE":"#FFF"}},sorting:!0},columns:[{field:"id",width:50,render:function(e){return o.a.createElement("img",{alt:"",width:40,height:40,src:u+"/preview/"+e.path})}},{title:"Image",field:"path"},{title:"Size",customSort:function(e,t){return e.width*e.height-t.width*t.height},render:function(e){return e.width+"x"+e.height}},{title:"Label",field:"annotation",render:function(e){return e.annotation&&e.annotation.items.length>0?o.a.createElement(h.a,null,"done"):""}}],onRowClick:function(t,a){return e.onSelect(a)},data:Object.values(t),title:"Images"})},g=a(224),v=a(430),E=a(237),b=a(230),p=a(433);function O(e){var t=e.image,a=e.astate.annotation,n=o.a.useState(1),i=Object(r.a)(n,2),c=i[0],s=i[1],d=o.a.useRef(null);if(!t)return o.a.createElement("span",null,"No Image");var m=u+"/image/"+t.path,h=2/c;return o.a.createElement(g.a,{m:1},o.a.createElement(g.a,{m:1},o.a.createElement(p.a,null,o.a.createElement(b.a,{onClick:function(){return s(c+.25)}},"+"),o.a.createElement(b.a,{onClick:function(){return s(c-.25)}},"-")),o.a.createElement(p.a,null,o.a.createElement(b.a,{disabled:!e.astate.changed,onClick:e.save},"Save"),o.a.createElement(b.a,{disabled:!e.astate.changed,onClick:e.revert},"Revert"))),o.a.createElement(g.a,null,o.a.createElement("svg",{ref:d,onMouseDown:function(t){var a=d.current;if(null!==a){var n=a.getBoundingClientRect(),o=t.clientX-n.left,i=t.clientY-n.top,r=e.astate;if(r.annotation){var s,u=r.annotation.items;void 0!==r.selectedId?(s=Object(E.a)(u))[r.selectedId]={id:r.selectedId,x:o/c,y:i/c}:s=[].concat(Object(E.a)(u),[{id:u.length,x:o/c,y:i/c}]),e.setAstate(Object(l.a)(Object(l.a)({},r),{},{annotation:Object(l.a)(Object(l.a)({},r.annotation),{},{items:s})}))}}},viewBox:"0 0 "+t.width+" "+t.height,style:{width:t.width*c,height:t.height*c}},o.a.createElement("image",{href:m,height:t.height,width:t.width}),a?a.items.map((function(t){return t.id===e.astate.selectedId?o.a.createElement("circle",{key:"circ"+t.id,cx:t.x,cy:t.y,r:2*h,stroke:"#ff0",strokeWidth:h,fill:"#f0f"}):o.a.createElement("circle",{key:"circ"+t.id,cx:t.x,cy:t.y,r:2*h,stroke:"#f0f",strokeWidth:h,fill:"none"})})):null,a?a.items.map((function(e,t){return t>0?o.a.createElement("line",{key:"line"+e.id,x1:e.x,y1:e.y,x2:a.items[t-1].x,y2:a.items[t-1].y,stroke:"#f0f",strokeWidth:h}):null})):null)))}var j=a(330);var w,k=function(e){var t=e.astate.annotation;return null==t?o.a.createElement("span",null,"Loading ..."):o.a.createElement(g.a,null,o.a.createElement(d.a,{options:{padding:"dense",paging:!1,showTitle:!1,search:!1,toolbar:!1,rowStyle:function(t){return{backgroundColor:e.astate.selectedId===t.id?"#EEE":"#FFF"}}},columns:[{title:"id",field:"id",width:20},{title:"Position",render:function(e){return e.x.toFixed(2)+","+e.y.toFixed(2)}}],onRowClick:function(t,a){a&&e.astate.selectedId!==a.id?e.onUpdate(Object(l.a)(Object(l.a)({},e.astate),{},{selectedId:null===a||void 0===a?void 0:a.id})):e.onUpdate(Object(l.a)(Object(l.a)({},e.astate),{},{selectedId:void 0}))},data:t.items.map((function(e){return Object(l.a)({},e)}))}),o.a.createElement(p.a,null,o.a.createElement(b.a,{onClick:function(){var t=e.astate.selectedId;if(void 0!==t){var a,n=[],o=Object(j.a)(e.astate.annotation.items);try{for(o.s();!(a=o.n()).done;){var i=a.value;i.id<t&&n.push(i),i.id>t&&n.push(Object(l.a)(Object(l.a)({},i),{},{id:i.id-1}))}}catch(c){o.e(c)}finally{o.f()}e.onUpdate(Object(l.a)(Object(l.a)({},e.astate),{},{selectedId:void 0,annotation:Object(l.a)(Object(l.a)({},e.astate.annotation),{},{items:n})}))}},disabled:void 0===e.astate.selectedId},"Remove"),o.a.createElement(b.a,{disabled:void 0===e.astate.selectedId},"Split")))},y=a(297),I={items:[]};!function(e){e[e.LOADING=0]="LOADING",e[e.ERROR=1]="ERROR"}(w||(w={}));var x=function(){var e=o.a.useState({}),t=Object(r.a)(e,2),a=t[0],n=t[1],i=o.a.useState(void 0),c=Object(r.a)(i,2),s=c[0],d=c[1],h=o.a.useState({annotation:I,changed:!1,annotationBackup:I}),E=Object(r.a)(h,2),b=E[0],p=E[1],j=o.a.useState({state:w.LOADING}),x=Object(r.a)(j,2),R=x[0],S=x[1],C=function(e){var t;B(),t=e&&e.annotation?e.annotation:I,p({annotation:t,changed:!1,annotationBackup:t}),d(e)};o.a.useEffect((function(){fetch(u+"/images").then((function(e){return e.json()})).then((function(e){S(null),n(e),C(e?Object.values(e)[0]:void 0)})).catch((function(e){S({state:w.ERROR,message:"Connection to service failed:"+e})}))}),[]);var B=function(){if(b.changed&&a&&s){m(s.path,b.annotation).then((function(e){console.log(e),e.ok&&200===e.status||S({state:w.ERROR,message:"Uploading annotation failed"})}));var e=b.annotation,t=Object(l.a)({},a);t[s.path]=Object(l.a)(Object(l.a)({},s),{},{annotation:e}),n(t),p(Object(l.a)(Object(l.a)({},b),{},{changed:!1,annotationBackup:e}))}};return R?R.state===w.LOADING?o.a.createElement(y.a,null):o.a.createElement(g.a,{color:"error.main"},R.message):o.a.createElement(v.a,{container:!0,spacing:3},o.a.createElement(v.a,{item:!0,xs:8},o.a.createElement(O,{image:s,astate:b,setAstate:function(e){e.changed=!0,p(e)},revert:function(){p(Object(l.a)(Object(l.a)({},b),{},{changed:!1,annotation:b.annotationBackup}))},save:B})),o.a.createElement(v.a,{item:!0,xs:4},o.a.createElement(f,{images:a,selectedImage:s,onSelect:C}),o.a.createElement(k,{astate:b,onUpdate:p})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[339,1,2]]]);
//# sourceMappingURL=main.9593f518.chunk.js.map